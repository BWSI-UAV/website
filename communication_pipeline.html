<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Communication Pipeline &mdash; Autonomous Air Vehicle Racing 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Autonomous Air Vehicle Racing
          </a>
              <div class="version">
                0.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Course Agenda:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">BWSI’s Autonomous Air Vehicle Racing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Syllabus.html">2024 Course Syllabus*</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial_setup.html">Module 0: UAV Environment Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="quadrotor_basics.html">Module 1: Quadrotor Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="computer_vision.html">Module 2: Computer Vision</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="vim_tutorial.html">Vim Text Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploring_px4_firmware.html">Exploring PX4 Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="kalman_filters.html">Kalman Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulation_challenge.html">Simulation Challenge</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_linefollowing_ideas.html">Advanced linefollowing ideas</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supplemental Material:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="team_roles.html">Team Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="safety_checklist.html">Safety Checklist</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Autonomous Air Vehicle Racing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Communication Pipeline</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/communication_pipeline.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Communication-Pipeline">
<h1>Communication Pipeline<a class="headerlink" href="#Communication-Pipeline" title="Permalink to this heading"></a></h1>
<p>In this unit we will gain understanding and practice on how information is passed between different components of the drone such as the onboard computer and the flight controller.</p>
<p>You should have already been exposed to the basic concepts of the Robot Operating System (ROS) during the online portion of this class. These concepts including things like nodes, topics, messages, services, etc. If you are unsure/uncomfortable with what these concepts imply, there are great tutorials online for walking you through the basics of ROS.</p>
<section id="Talker---Listener">
<h2>Talker - Listener<a class="headerlink" href="#Talker---Listener" title="Permalink to this heading"></a></h2>
<p>We are going to put some of basic tools of ROS2 into practice on the Intel RTF Drone. We are going to start by creating and sending a simple message in one ROS2 node (i.e. talker) and receiving it in another.</p>
<p><a class="reference external" href="https://ros2-industrial-workshop.readthedocs.io/en/latest/_source/basics/ROS2-Simple-Publisher-Subscriber.html">Pub-Sub Tutorial</a></p>
<section id="Question-Set-1:">
<h3>Question Set 1:<a class="headerlink" href="#Question-Set-1:" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p>List all rosnodes that exist after running the publisher</p></li>
<li><p>List all rostopics that are being present after running the publisher</p></li>
<li><p>What command do I run to see what is being published to a topic?</p></li>
<li><p>What would I change in the publisher to make it publish messages more frequently?</p></li>
<li><p>In terminal I run the python script for the subcriber and see information being printed. Does this mean it is publishing to a topic?</p></li>
<li><p>What is the main benefit of a composed node? How might this help in drone autonomy applications?</p></li>
</ol>
</section>
</section>
<section id="Launch-Files">
<h2>Launch Files<a class="headerlink" href="#Launch-Files" title="Permalink to this heading"></a></h2>
<p>It’s a cumbersome to be opening a different terminal for every different rosnode you want to start. Instead of doing this, we can use launch files.</p>
<p>Read the launch file tutorial here: <a class="reference external" href="https://docs.ros.org/en/humble/Tutorials/Intermediate/Launch/Creating-Launch-Files.html">Creating a Launch File</a></p>
<section id="Question-Set-2:">
<h3>Question Set 2:<a class="headerlink" href="#Question-Set-2:" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p>What needed to be added the launch file?</p></li>
<li><p>With <code class="docutils literal notranslate"><span class="pre">rqt_graph</span></code> open, use the button in upper right corner to save an image of the graph and include it in this report. Which components in the graph indicates rosnodes and which indicate rostopics?</p></li>
<li><p>Why do we need to run the command when and why do we need to source a bash file?</p></li>
<li><p>Were there any steps that didn’t work or were particularly confusing? How did you work around them?</p></li>
<li><p>Create a launch file for the subscriber and listener you made above.</p></li>
</ol>
</section>
</section>
<section id="Document-and-Push">
<h2>Document and Push<a class="headerlink" href="#Document-and-Push" title="Permalink to this heading"></a></h2>
<p>Congratulations! You have implemented one of the basic building blocks of ROS! Now that you have this demo complete, you will want to push your code changes to your GitHub.</p>
<p>First double check that the repository you are working with on your drone or laptop points to the correct remote repository.</p>
<p>Finally, document the answers to question sets and push those to your teams <code class="docutils literal notranslate"><span class="pre">documents</span></code> repository. You can write up the answers any way you want, but the easiest is probably to create a file called <code class="docutils literal notranslate"><span class="pre">communication_pipeline_answers.md</span></code>, and write a bullet point or paragraph for each question.</p>
</section>
<section id="microXRCE-DDS">
<h2>microXRCE-DDS<a class="headerlink" href="#microXRCE-DDS" title="Permalink to this heading"></a></h2>
<p>The microXRCE-DDS (eXtremely Resource-Constrained Environment Data Distribution Service) client for ROS 2 and PX4 is a middleware that enables communication between microcontroller-based systems and the ROS 2 ecosystem. It facilitates efficient and reliable data exchange for resource-constrained devices, such as drones and embedded systems.</p>
<section id="Steps:">
<h3>Steps:<a class="headerlink" href="#Steps:" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Navigate into your PX4-Autopilot folder and make the simulator</p></li>
</ol>
<img alt="image.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnkAAAA4CAYAAACBku5BAAAABHNCSVQICAgIfAhkiAAAABl0RVh0U29mdHdhcmUAZ25vbWUtc2NyZWVuc2hvdO8Dvz4AAAAtdEVYdENyZWF0aW9uIFRpbWUAU3VuIDA3IEp1bCAyMDI0IDA4OjExOjAyIFBNIEVEVF1+MEoAABGeSURBVHic7d19WJR1vsfxdw4DMyQgjgh6oahZk2FBJ/WsXnamSyuoo3HW0tzFY5Yru0kLrk9Ho6jslB4xVy2t7Mn1wClw6yxhq7gHz04PVj5sUliioUyQPDkq6HEGhrHzx6COiC2gldHndV1cXnP/7vv3+9384+f6fu97uOLkSdc3iIiIiEiX0u2H3oCIiIiIXHoKeSIiIiJdkEKeiIiISBekkCciIiLSBSnkiYiIiHRBCnkiIiIiXdB3F/KO1nBn6l5W1n5nKwjAiW0k21KZ/hfPeUM1G5YRMTKVkJGpRMwowvF97Md7kEXJc0ne1PB9rCYiIiIXcPlU8hybGTvaF0hCRqYSYpvLsN+sY22Jyze+v4CxYzLJKPYLM94KsqbOYtjyUtznTehk7UOzCEnKY7u3E9t5YxkRI2dxT34nw8quPIZl7GhjX5eY2UrK7ElMHWI8byhy4lzq7CvY+WC/i1iggfWzl5C1v31n12zaxHpGMf/20ItYU0RERC7W5RPyAAxRzHtuEV/mL6bktRmk9atg0e9eY30tcHUiiycY+cMzmylu8p3u2JDLyhPDeSrFiqnVVDUbc1lV2tmNOMkvquSGIRY+2voJNZ2YoebAV1R3dvmOMFiwJdmwRV9gPNCIyXAR83srKC47v0rYpqaDrMo+gG3arcRdzJoiIiJy0dod8uodNcxc+hkDU/9Gz1kl/DzHyV7///sb6nliRQl9Uncz8JH9PFHS3KkNmcMtRPYOJWaQlanzxpPAPgp3uQAjI6ZP4l5XERkbqqHWzpw/OEl4aDwJ3VtNcmw3i7KbSfnXawjrzCYcO8gvG8R96cOJ/6yYQv+Ws3c308csZM4uv2P2l4gel4PdC+Aib14qg5cfpH7rujPt0uhFe85Zor54M9MfWEi0bRbR454k+bndOM5UHBtY+9Asxj6/jayMJYyeuJDBE5aRsdXpd4927vGrfLbVrv37PBTn5zBuwlwibLMYPHEZczZWn60+fvEWw2xrWFtbzaKpLWuNXsKqyrZnq9lUQG6gjbQxquKJiIj80NoX8hqczFpZTdX1A/hoeTwHF/RlQGkFv3yzviUQeCn8YzkvuMP5U1Y8Bx/uS9SnR/ioE23SNgUE+P41W8lMj6d83TqSFxWwe+h4nj4vULiwv1SAY/wkUqLPb2G2R2nRDkqvjyNh6HBuv+oAee93pGVrZtKSFRRNtGCyTaPSvoI6+woqM2LPnlJrZ/rc/6H+9hT2bF3Bl6vHYtq6jgdyztb+TAYPn76zk6Dpc3h/w2I+eDCM/MW55J3OeT1s/NG+grqtaaT16dx91ttzSH6ughEZmdTZs/ggvT8fZ63hydMt8SET2Jk/iYTAKOa96ruPOvsC0tqqGjaVsir7K1XxRERELhPtCnk1Ow+TH9yTxxNCiAzqRlhUTx6f3p9/G9oSLk6dYPMX33DLLVH8YzAQfCW/vjWUqIv5z77JSeHazRRyDUn/cDbEhI2eQGZ8NW9/FsX89FFEtrrMXbKJjC/ieWpi1Hkt3Pap4O0iJz8bcyORBgtJt0Sxe+uOjrVsDUYwAAYICjRiCmz53MKxdQf2HqN4dOJAwgxgihlF5r9E8WnhDkr9gnFQ3EhSBvnuPXLMKBKC9lHo/0yiwYgpMLBTdwkuCjftxn3LeObfFAoYiRydSMpNDeRvOeC3Cd/65gDffVyo9evYWEiu2cZ8m7mT+xEREZFLqV0h74uqJuhtYoDf2WExPbl3aLAvSLmbqD5pYEC4XwLoFcSAju7GW83S+2cRYZtFhC2T6fZQ0pdMYZLF75wTFXxcBiaqsX/WqsLmreDZlXuwpScSd8Hs4yJv9iy/FzyWsbbKb3j/DvKrBnHXaF+FMGZ0PNbPPyG/qu3ZOqO8wgn9ohjg9+uKjLYQVOWk/MwRI1HRfkHVYCGqJ9Q4L9Vbq4dxHIKYAf5hOJRro83UVFVT35GpXKWsyq4iYfqtWFXFExERuSwEtPvMUx2c2XsKVwcvwWAhZclMUvoZMZlDibS0bkN6sK/NJb/veN6ZUcovX3iLwpHTSOjhG3VsyCX/qgm8E/dt7UszCfMWsPPM5oxE9T47Wly4m2KXk4cnzuLhlmONLg9mu5OUyRa+U60C0jmVSK8HvACda812TMfWcOQXkNvDRtFoVfFEREQuF+0KeUP6BMIXbspPQVxLNa/+yzrWVZmYdnMIYaZAooK8lB/2crqU465qorzDz+QZ6REZRcwF3hR1lxSQsTGYX788lhGD4pm/eTEZL+zhZwtiCcNJftFBSste46ailgu8LupdMGHcAdJXLWDe1b7DYX2i2n4hw3uQPHsDtocWsHpM8JnD5XlruKdoB47JicTge17O3XT2shpnPY0EtzFf2/dx7QALbK+m3MuZ59cclU4a+8T6Vfc8lFc5cdPPF/a8TsqPQGTvSxWkemHtCy+WVePG0hIoG9jrcBEZYznn9xP0bdO49rDqdSdJs22q4omIiFxG2tWujRzWk4STR3i88Dg1nlPUVx/h8fVf80ZtSwDo1p1brruCv/71EH89egq38xj/YT9+aXfqreDZ5e/ChHv57SAACynpNsK25LK02OP7nLWYkjcy+SDH91OUHovJMpw1r85suebvKNlBYW00d93Wj5g+ljM/tjvjse7bTX4lYIhiQB8XxbsO+l46OVbKi1vO/7KUsPBgKNvHlsoGamqdFJecbYFG2kZx+7FtPLmhgnrA7djG0j9V84/jR2H1m6Pxb+/ybHED4KH0rXcpbL6GhNNVSq8Hd5MHd5Mvbbqbm3E3edoMlqbAADjupOaE7xofM7Zx8Zje23RmDYe9gLWfWbjvDr9dBAZjCnTy8faD1DgbcDgOUlx19rlAx1ubyO1tI03P4omIiFxW2teuDY3ghYe8LMwrJz7fQ2NwILaf9ef1n4e0VIAMJN0dw0evVvCLhXWYeoXwm7sjiC89grujbd4LcGzIZeWx4eRMG3i2jTkokcVJO5jwzGYmvTyeuB6h57Y4Q4wEGYKJ6h3aju+K87C96BMc199KUu9WQ4Piub1PEflbq0mbGkXKg2P5OGs1Q7eGEdNvEL8edyMxL5x7iTUxkZT3cpk5eRuN5lCs19lYvTzRV7nrPYo1SxqYvXINsc+7IMRCwoQZvDLRvx1sxDomjqDXVzL4d07cIdHc90gyk3oAOFmbmsmcYr/TF80lYhHQYxQbNyZj83/eb8Rwbn/9vxl7mx2AuzKWkTPOTNjoZHIezCHjiUyWOiGszyCmPjaTeUP85g2MJW36NUx/ZRmDnzcS2TuKpIdm8kwfI5zYzdI8J0nzbOeEUxEREfnhXXHypOubH3oT0loD69MzWTt0Du/PuJi/ViEiIiI/VZfXX7wQERERkUtCIU9ERESkC1K7VkRERKQLUiVPREREpAtSyBMRERHpghTyRERERLoghTwRERGRLkghT0RERKQLUsgTERER6YIU8kRERES6IIU8ERERkS5IIU9ERESkC/r+Ql5lJc9O+Jz3Dn9vK/4IOFk1I5XBS/Z0/FJvKXPGpRIyMpWQkXNJ/fDS705ERER+vFTJ+zbOHUy/I5WIjN3f0QKhJEyZxNN39Gt7eFcewzJ24G5rzGDlmfwV1G2dwdQe39H2RERE5Ecr4IfewOXLReELBRQ2G7/DNYxYbTasFxitOfAV1Qy88OUGI6bA73J/IiIi8mPVjpDn4n9/t4+vbwjluP0IR6+O5u7Yev785nE8sf2ZsSCCcICjx9jybAU7P3Vx/JSB8NheJKXHYO11gWkrq3l5YRWm+69jypgg37HDR9myppKdnzbiwkDPGyO4c2Y01vB23s2uHIY+4iEt1ciWvFL21nnoEWdj+SOJjOgOuErJ+NVLFN85l43JUb5rHEWM+5WduKcW8tQI85mp3LsKeLIsnvm37GDpyXauf1pTNXkrs1m6tRLHcYgcFEtK+hTSbjo9fzVZU59k0X7fp8ikmXy5INZvAhd58+Yy/X2Ag0SMXAdA2B0zqcz0P09ERESkbe1q1wYYPJRVBDNlVTR9P6kgv6Y3Dy6NxLy9jpLDAF72vFzGeyfCmfLqMBb/5xBGcpg3XnPS3NaEDUd5+9+/xvPPVzP5dMDDxXtLDrAnvC8PZg/jyWwrNxvqeGN5NUfbezcBRji+m/VfxLJ6/SJK3ppJUu1mZq476Bs3W3l04SiOZWez1gF4q1mbtYljSffzqF/Ao6mCZ1eXYku/g7jA9i5+Vk1+NrP3WVmTnUXd+1m88wtYn1XAdu/pM6KY99oK6uzLyLnNiOm8GcxMWrKCookWTLZpVNpXUGdfQWWGAp6IiIi0T7ufyesZG0rIlWZ6hkHfa0Mx9TYT3s2LqwHAQOxvbyDjsb70D+0GVwYTP8JMc/n/Udt6Is9J3ssqZ2/sIKZM7n62lHigjp0HruTm+yyEmwBTMMOmRNBzz5GWINleFpLujicSwNyPqXdE49heQmnLqGnoeFZPbGZp1mYKN2Sz9KSN1SkDzwlapRtyyR8ygUfjzOdP3w7Vh10QFExkDyNgJOaOGex8YxIjDH4nGYyYAgMIutAkBiMYAAMEBba0ZQ0XOllERETkXO1+Js/cPRDwENDtCoxmgG4YDadobqlONR86wpb1tewtb/ZV71xemsO7gxe/cOKh7MX9lJV1Z3JGOCF+8zcfauRIUwNv/nI7b56zchAxh4ELtX1bM1iI6XP2Y5gljKAjDVR7wWoAMBJ33zTSPlzCPc9Hkfly4rnVuio7GQW9mP9CbBsVtvaJGz+WhL/kMWzcNmzDrfzTzcO5d8xAIhXSRERE5HvS7pAX4B9QWtf/vA38+SkHe6+/ihlrLYQHwvGCz1n6TuvzGjmEBWvoUbbknsB6n18lzwCYwpnyX1cT24kW6bdpbH3A5cRxDMIM9ZQfcsHVp19eaCDvuXcJuy+duy7mjdXoUbyy4UZKd31C4Yd72PLcSpbmJfLO6sROtX9FREREOurSfIXK4RN8fTSIoYm+gAenqK1oPP95PEN3bn7oKibPioCCg2z5/NSZoYC+ZnqecvN1pd/5Xg/Hj55qPcu38zpxVJ39WFPlhJ4Wos6EVBeFK7MpHJJM0WNW7MtzedvZMnSihPz3qylcvojBt81l8G1zSd7YQL19HYMn52H30j5eD27MWEeMIi19Bhv/kIytfBt5+zp2K765OnGNiIiI/ORdmpAXFkRINw+HDjQCpzi+s5IP93cjwO3F1UZICbi2H3ePhw9/76Ds9JfAxVgYNriRD187xFcNgNvFnhf3svyxQxzqUNBxkv/6NhwuoHYPqwqqsY6MPfM1JTVbs5mz3crTs4djtd3LMzcdYPaSbdQAdB/Omg2L2ZWTyQc5mXyQs5A1Y0MJG/lzilaPx9audquLvIyFjM7aTU0TgIeasgqq6YW1d8spXqDJg7upmUbADbibPLhb3WdYeDCU7WNLZQM1tU6KS6qpP/+3icnQzLHaBtxNHoVCERERAS7V9+SZwrn9ASc52Z/xRJ6R3jf15e75ZljoIHuugft/35/+51zQjf6/GMjNu/by5kvhpP22BybM3LxwMM1rKsh+4JDvK1RusHDPwr707cizbIZrmBR3kNTkPD52BmAdPZ7V01q+bLh2Bw8vP4BtXmZLO9ZMQtq9JDyQTepbVv44wUJYbyNhftOFmYHGMGIs7X0Jw8yk2VPYm1XA2MR11HghLPoapj6SzNSWkFe89klGr6/2u2YNEfmAwcK8lxaROcR31JqYSMp7ucycvI1GcyjW62ysXp5I3DkvcPTnrsQopmctJGIJED2WojcmnPuSh4iIiPzkXHHypOubH3oTl0xxHkPT6nl66wzuUsgRERGRnzD9xYuO2F9E6iulHLtQS9TQi3vTJ3FXnwuMi4iIiHxPFPI64uqxrF4y9ofehYiIiMjf1bXatSIiIiICXKq3a0VERETksqKQJyIiItIFKeSJiIiIdEEKeSIiIiJdkEKeiIiISBekkCciIiLSBSnkiYiIiHRBCnkiIiIiXZBCnoiIiEgXpJAnIiIi0gX9PybAzGQPo2wDAAAAAElFTkSuQmCC" />
<ol class="arabic" start="2">
<li><p>Follow this link and scroll down to ‘Setup Micro XRCE-DDS Agent &amp; Client’</p>
<p><a class="reference external" href="https://docs.px4.io/main/en/ros2/user_guide.html">MicroXRCE Setup</a>.</p>
</li>
</ol>
</section>
<section id="Question-Set-3:">
<h3>Question Set 3:<a class="headerlink" href="#Question-Set-3:" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p>What happens after you run the DDS Client? Post a screenshot of your terminal output</p></li>
<li><p>What happens when you run [ros2 topic list]?</p></li>
<li><p>What happens when you run [ros2 node list]?</p></li>
<li><p>Pick a topic and try to view the inforumation using echo. Were you able to? What package makes this possible?</p></li>
<li><p>Launch QGround Control and the px4_sitl [make px4_sitl]. Can you figure out how to takeoff and land the drone? Save a screen recording of your team taking off and landing the drone.</p></li>
</ol>
</section>
</section>
<section id="MAVROS-for-ROS2">
<h2>MAVROS for ROS2<a class="headerlink" href="#MAVROS-for-ROS2" title="Permalink to this heading"></a></h2>
<p>Communication with the PX4 Firmware running is managed with a service called <a class="reference external" href="https://mavlink.io/en/">MAVLink</a>. Similar to how ROS messages pass information between nodes on Ubuntu, MAVLink messages pass information between ROS/Ubuntu/Compute Board and PX4/NuttX/PixHawk.</p>
<p>The MAVLink protocol is low-level, which makes it powerful and extensible, but also complicated to use. To simplify our lives, we will make use of <a class="reference external" href="https://github.com/mavlink/mavros/blob/ros2/mavros/README.md">MAVROS</a>. MAVROS can be thought of as a “wrapper” for MAVLink that simplifies the communication with ROS.</p>
<p>For ROS 2, most of the communication can be done via <a class="reference external" href="https://github.com/eProsima/Micro-XRCE-DDS">microXRCE-DDS</a>, if the controller supports it. It integrates seamlessly with the DDS-based communication system in ROS 2, allowing small devices like microcontrollers to participate in ROS 2 networks.</p>
<p>However, MAVROS offers more tools and extensive support for high-level control and monitoring of MAVLink-based drones. It provides a rich feature set and robust support for a wide range of MAVLink functionalities, making it a preferred choice for many drone applications.</p>
<section id="Summary">
<h3>Summary<a class="headerlink" href="#Summary" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>MAVROS</strong>: Simplifies MAVLink communication for ROS 2, providing extensive tools and support for drone-specific functionalities.</p></li>
<li><p><strong>microXRCE-DDS</strong>: Enables DDS-based communication for resource-constrained devices within ROS 2, useful for integrating microcontrollers and small devices.</p></li>
</ul>
<p>Depending on your specific needs and the capabilities of your drone’s controller, you can choose the most appropriate communication method.</p>
<!-- ### Step 2. Sending Commands

Next we are going to use the `mavros` node to send commands to PX4 and receive information about the state of the quadrotor. Since we are only learning the communication structure of the drone, we won't actually be flying it with these commands, just observing that they get passed correctly.

In `aero_control/communication_pipeline/src` you should find two other files `dispatcher.py` and `command_generator.py`. As with the previous section, these files are missing a block of code that you need to fill in; see the code for instructions on what needs to be completed.

Once you have completed writing your code, let's test it out. On the drone in multiple terminals run:

_Terminal 1:_
```
roscore
```

_Terminal 2:_
```
rosrun mavros mavros_node _fcu_url:=tcp://127.0.0.1:5760 _system_id:=2
```

_Terminal 3:_
```
cd ~/bwsi-uav/catkin_ws/src/aero_control/communication_pipeline/src
python dispatcher.py
```

_Terminal 4:_
```
cd ~/bwsi-uav/catkin_ws/src/aero_control/communication_pipeline/src
python command_generator.py
```

Assuming you got no errors, answer the following questions (if you did get errors, are you able to debug them?)

#### Question Set 2:

1. What new nodes and topics were created by running dispatcher.py and command_generator.py that weren't present when just running mavros?
2. Inspect the messages being sent on `/velocity_command` and `/mavros/setpoint_velocity/cmd_vel_unstamped`. Do they appear to be the same? Are the being passed at roughly the same rate? Which one is actually being sent to the PX4/AeroFC?
3. Why would we want to impose a limit on the velocity command sent to the flight controller?
4. As with the previous section, it is cumbersome to run each command in a separate terminal. To this end we have included a partial launch file in `aero_control/communication_pipeline/launch/mavros.launch`. Can you complete the launch file and run it in order to kick off mavros, dispatcher, and command_generator simultaneously?
5. When all nodes are running, use rqt_graph to generate an image of the nodes and topics.

### Step 3: Document and Push

As before, document the answers to the preceeding question sets and push them to your team's `documents` repository --></section>
</section>
<section id="Advanced-Topics:">
<h2>Advanced Topics:<a class="headerlink" href="#Advanced-Topics:" title="Permalink to this heading"></a></h2>
<section id="uORB">
<h3>uORB<a class="headerlink" href="#uORB" title="Permalink to this heading"></a></h3>
<p>So far we have only seen communication on the Compute Board/Laptop and how to pass messages to the Flight Controller. We haven’t actually looked at message passing that occurs onboard the Flight Controller in the PX4 firmware. The Flight Controller uses a different system known as “uORB”. We will cover this in a later lecture but you can learn more uORB in the link below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.px4.io/main/en/middleware/uorb.html">uORB Messaging</a></p></li>
</ul>
</section>
<section id="ROS2/ROS1-Bridge">
<h3>ROS2/ROS1 Bridge<a class="headerlink" href="#ROS2/ROS1-Bridge" title="Permalink to this heading"></a></h3>
<p>ROS2 is fairly new and most legacy systems are running on ROS1. In fact, proceeding with this course with ROS2 was a bold choice to make as there are many roadbumps that may be new to all of us. A ROS 2/ROS 1 bridge is a communication bridge that allows nodes from ROS 2 to interact with nodes from ROS 1, enabling data exchange and interoperability between the two versions of the Robot Operating System. It facilitates the transition from ROS 1 to ROS 2 by allowing developers to integrate existing
ROS 1 nodes with new ROS 2 nodes, thus leveraging the strengths of both systems and ensuring compatibility during the migration process: - <a class="reference external" href="https://github.com/ros2/ros1_bridge">ros2_ros1_bridge</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Beaver Works Summer Institute, Nathaniel Hanson, Kendrick Cancio, Ross Allen, Mark Mazumder.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>